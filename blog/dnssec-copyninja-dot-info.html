<!DOCTYPE html><html lang="en"><head><link href="https://fonts.googleapis.com/css?family=Cantarell" rel="stylesheet"><title>Enabling DNSSEC for copyninja.info</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://copyninja.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Random Ramblings Full Atom Feed"><link href="https://copyninja.in/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Random Ramblings Categories Atom Feed"><link rel="stylesheet" type="text/css" href="/theme/css/pygments.css"><link rel="stylesheet" type="text/css" href="/theme/css/default.css"><meta name="tags" content="dnssec"><meta name="tags" content="sysadmin"><meta name="tags" content="technology"></head><body><div id="header" class="body"><div id="navigation"> | <a href="https://copyninja.in">Home</a> | | <a href="https://copyninja.in/about">About</a> | | <a href="https://copyninja.in/contact">Contact</a> | | <a href="https://copyninja.in/categories.html">Categories</a> | | <a href="https://copyninja.in/tags.html">Tags</a> | </div><h1><a href="https://copyninja.in/blog/dnssec-copyninja-dot-info.html">Enabling DNSSEC for copyninja.info</a></h1></div><div id="content"><section id="content" class="body"><footer class="post-info"><p> Posted on May 13, 2014 By copyninja under devops </p></abbr></footer><div class="entry-content"><p>Recently I've been seeing lot of posts about DNSSEC on Internet and I thought I should configure my domain to be secured by DNSSEC.</p><p><strong>copyninja.info</strong> domain is now secured with DNSSEC you can verify this by <a class="reference external" href="http://dnssec-debugger.verisignlabs.com/copyninja.info">DNSSEC analyzer by Verisign</a> and <a class="reference external" href="http://dnsviz.net/d/copyninja.info/dnssec/">DNSViz</a> online tool or by installing <a class="reference external" href="http://dnssec-validator.cz/">DNSSEC validator addon</a> for your browser.</p><p>There are good amount of tutorials and guides available to enable DNSSEC for your domain, still I want to note down steps I followed to here for the record (of course it will be helpful for me if I forget it ;-))</p><p>First step will be installing <cite>bind9</cite> and <cite>dnssec-tools</cite> package, if you use aptitude installing <cite>dnssec-tools</cite> will pull down the <cite>bind9</cite> unless you have configured aptitude to not install the <strong>Recommends</strong>.</p><p>Next setting up the zone file for your domain, for this first make a copy of /etc/bind/db.local as /etc/bind/db.example.com, replace example.com with your domain name. Now you need to add your zone records to the zone file.</p><p>Next edit the /etc/bind/named.conf.local file and add following lines</p><pre class="literal-block">
zone &quot;example.com&quot; {
    type master;
    file &quot;/etc/bind/db.copyninja.info&quot;;
    allow-transfer {secondary;};
};
</pre><p>Here replace secondary with your secondary DNS servers, if you don't have one you can ommit this but its always recommended to have secondary DNS servers for a zone, in cases when primary fails. After this we need to enable DNSSEC on bind, this is done by editing the file /etc/bind/named.conf.options. Add following lines into <strong>options</strong> section.</p><pre class="literal-block">
dnssec-validation yes;
dnssec-enable yes;
dnssec-lookaside auto;
</pre><p>A more explanation on this can be found on <a class="reference external" href="http://www.linuxjournal.com/content/dnssec-part-ii-implementation">Linux Journal article</a>.</p><p>Now its time to create DNSSEC keys and sign your zone, more about different DNSSEC keys and records can be found in the <a class="reference external" href="http://www.linuxjournal.com/content/dnssec-part-i-concepts">Linux Journal Article on implementation</a>.</p><p>I used <cite>zonesigner</cite> utility from dnssec-tools which does job of signing and including KSK and ZSK keys into bind configuration which otherwise should be done manually. Here is the command line I used for generating keys, thanks to <a class="reference external" href="http://dr.jones.dk">Jonas</a> for this.</p><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/bind/keys
zonesigner<span class="w"> </span>-algorithm<span class="w"> </span>RSASHA256<span class="w"> </span>-keydirectory<span class="w"> </span>/etc/bind/keys<span class="se">\</span>
<span class="w">       </span>-dsdir<span class="w"> </span>/etc/bind/keys<span class="w"> </span>-archivedir<span class="w"> </span>/etc/bind/keys/archive<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>/etc/bind/db.example.com
</pre></div><p>Here we store our keys into /etc/bind/keys directory, and use <strong>RSASHA256</strong> algorithm for key generation which is more stronger than the default used RSASHA1 (atleast thats what Jonas told me). This will create ZSK and KSK for the signing zone and creates a signed zone file db.example.com.signed in same directory as original zone file. Now all you need to do is replace the zone file from db.example.com to db.example.com.signed in <em>file</em> directive with your <cite>named.conf.local</cite> file.</p><blockquote> Note that this keys expire after 30 days so you need to resign your zone before 30 days. For resigning just run zonesigner from /etc/bind/keys. You can setup cron job to do this periodically.</blockquote><div class="highlight"><pre><span></span>zonesigner<span class="w"> </span>-zone<span class="w"> </span>example.com<span class="w"> </span>/path/to/db.example.com
</pre></div><p>Our signed zone is ready but we are not done yet! For DNSSEC to work others should trust your signed record for this you need to register your public keys with registrar for your domain and this can be done via your domain provider (in my case this is Gandi).</p><p>You need to check your domain name providers documentation on how to do this. For Gandi users there is a nice <a class="reference external" href="http://wiki.gandi.net/en/domains/dnssec">documentation</a>.</p><div class="section" id="reference"><h2>Reference</h2><ol class="arabic simple"><li><a class="reference external" href="http://www.linuxjournal.com/content/dnssec-part-i-concepts">Linux Journal - DNSSEC concepts</a></li><li><a class="reference external" href="http://www.linux-journal.com/content/dnssec-part-ii-implementation">Linux Journal - DNSSEC implementation</a></li><li><a class="reference external" href="https://www.dnssec-tools.org/wiki/index.php/Sign_Your_Zone">Signing your zone</a></li></ol></div></div><div id="footer"><p><italic>Tagged as: dnssec, sysadmin, technology, </italic></p></section></div><hr><div id="footer"> Site Proudly powered by <a href="http://getpelican.com/">Pelican</a></div></body></html>